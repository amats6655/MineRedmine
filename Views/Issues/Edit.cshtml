@model Redmine.Net.Api.Types.Issue

<h1 align="center">Заявка #@Model.Id</h1>
<br/>
<section class="wrapper">
    <div class="container">
        <div class="detail bg-light mb-3">
            <div class="card-body">
                <p><strong>Создано: </strong>@Model.CreatedOn.ToString()</p>
                <p><strong>Заявитель: </strong>@Model.Author.Name</p>
                <p class="card-text text-wrap"><strong>Тема: </strong>@Model.Subject</p>
                <p><strong>Телефон: </strong>@GetPhoneNumber()</p>
                <p><strong>Местоположение: </strong>@GetLocation()</p>
                <p><strong>Описание: </strong><br/>@Html.Raw(Model.Description)</p>
            </div>
        </div>
        @* <div align="center"> *@
        @*     <form action="@Url.Action("TakeIssue", "Issues", new { id = Model.Id })" method="post"> *@
        @*         <button type="submit" class="custom-button">В работу</button> *@
        @*     </form> *@
        @* </div> *@

    </div>
</section>
<hr/>

@foreach (var t in Model.Journals)
{
    @if (!string.IsNullOrEmpty(t.Notes))
    {
        <blockquote class="speech-bubble">
          <p>@Html.Raw(t.Notes)</p>
            <cite>@t.User.Name</cite>
        </blockquote>
    }
}
<br/><br/>

@functions{
    private string GetPhoneNumber()
    {
        var phone = "Не указан";
        foreach (var t in Model.CustomFields)
        {
            if (!t.Name.Equals("Телефон для связи")) continue;
            phone = t.Values[0].Info;
            break;
        }
        
        return phone;
    }
    private string GetLocation()
    {
        var location = "Не указано";
        foreach (var t in Model.CustomFields)
        {
            if (!t.Name.Equals("Местонахождение")) continue;
            location = t.Values[0].Info;
            break;
        }
        
        return location;
    }
}

